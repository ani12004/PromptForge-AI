module.exports=[62179,a=>{"use strict";var b=a.i(45618);a.s(["createClerkSupabaseClient",0,a=>(0,b.createClient)("https://cnfmdfwpicltzthzglzj.supabase.co","sb_publishable_H4700JmeezyvZawo6rovMA_z2uVjZuv",{global:{headers:a?{Authorization:`Bearer ${a}`}:void 0}})])},2110,77728,27607,a=>{"use strict";var b=a.i(37936),c=a.i(5072),d=a.i(62179),e=a.i(13095);async function f(){try{let{userId:a,getToken:b}=await (0,c.auth)();if(!a)return"free";let e=await b({template:"supabase"}),f=(0,d.createClerkSupabaseClient)(e),{data:g}=await f.from("profiles").select("subscription_tier").eq("id",a).single();return(g?.subscription_tier||"free").toLowerCase()}catch(a){return console.error("Error fetching subscription:",a),"free"}}async function g(){let{userId:a,getToken:b}=await (0,c.auth)();if(!a)return null;try{let c=await b({template:"supabase"}),e=(0,d.createClerkSupabaseClient)(c),{data:f}=await e.from("profiles").select("role").eq("id",a).single();return f?.role||"user"}catch(a){return console.error("Failed to fetch user role",a),"user"}}(0,e.ensureServerEntryExports)([f]),(0,b.registerServerReference)(f,"00b21639a03642d5844bfb915c6d5ce1988f5b95e0",null),a.s(["getUserSubscription",()=>f],2110),(0,e.ensureServerEntryExports)([g]),(0,b.registerServerReference)(g,"006aeb6e7970a12213649aa3fb647b23db3302889d",null),a.s(["getUserRole",()=>g],77728);var h=a.i(5246);async function i(){(await (0,h.cookies)()).delete(`__clerk_invalidate_cache_cookie_${Date.now()}`)}(0,e.ensureServerEntryExports)([i]),(0,b.registerServerReference)(i,"006aebffc138bbe85fa0f45a766f7037c176527adf",null),a.s(["invalidateCacheAction",()=>i],27607)},63733,a=>{"use strict";var b=a.i(2110),c=a.i(77728),d=a.i(26022),e=a.i(27607),f=a.i(85978),g=a.i(37936),h=a.i(12746),i=a.i(87128),j=a.i(45069),k=a.i(13095);async function l(){if(!await (0,i.isAdmin)())throw Error("Unauthorized Access")}async function m(){await l();let a=(0,h.createAdminClient)(),{count:b,error:c}=await a.from("profiles").select("*",{count:"exact",head:!0}),{count:d,error:e}=await a.from("contact_messages").select("*",{count:"exact",head:!0}),{count:f,error:g}=await a.from("contact_messages").select("*",{count:"exact",head:!0}).eq("status","unread");return c||e||g?(console.error("Error fetching stats",c,e,g),{totalUsers:0,totalMessages:0,unreadMessages:0}):{totalUsers:b||0,totalMessages:d||0,unreadMessages:f||0}}async function n(){await l();let a=(0,h.createAdminClient)(),{data:b,error:c}=await a.from("profiles").select("*").order("created_at",{ascending:!1}).limit(100);return c?(console.error("Error fetching users",c),[]):b}async function o(){await l();let a=(0,h.createAdminClient)(),{data:b,error:c}=await a.from("contact_messages").select("*").order("created_at",{ascending:!1}).limit(100);return c?(console.error("Error fetching messages",c),[]):b}async function p(a,b){await l();let c=(0,h.createAdminClient)(),d=b.get("subject"),e=b.get("message");if(!d||!e)return{error:"Title and Message are required"};let{error:f}=await c.from("notifications").insert({title:d,message:e,type:"info",user_id:null});return f?(console.error("Failed to create notification",f),{error:"Failed to publish notification"}):{success:!0,message:"Notification published to all users."}}async function q(a,b){await l();let c=(0,h.createAdminClient)(),{error:d}=await c.from("contact_messages").update({status:b}).eq("id",a);return d?(console.error("Error updating message status",d),{error:"Failed to update status"}):{success:!0}}let r=new j.Resend(process.env.RESEND_API_KEY);async function s(a,b,c,d){if(await l(),!process.env.RESEND_API_KEY)return{error:"RESEND_API_KEY is missing"};try{let{data:e,error:f}=await r.emails.send({from:"PromptForge Studio <onboarding@resend.dev>",to:[a],subject:b.startsWith("Re:")?b:`Re: ${b}`,html:`
            <!DOCTYPE html>
            <html>
            <head>
                <style>
                    body { font-family: 'Inter', sans-serif; background-color: #000000; color: #ffffff; margin: 0; padding: 0; }
                    .container { max-width: 600px; margin: 0 auto; padding: 20px; background-color: #18181b; border: 1px solid #333; border-radius: 12px; margin-top: 40px; }
                    .header { text-align: center; padding-bottom: 20px; border-bottom: 1px solid #333; margin-bottom: 20px; }
                    .logo { height: 40px; }
                    .content { font-size: 16px; line-height: 1.6; color: #e5e7eb; }
                    .quote { margin-top: 20px; padding: 15px; background-color: #27272a; border-left: 4px solid #8b5cf6; color: #9ca3af; font-size: 14px; border-radius: 4px; }
                    .footer { margin-top: 30px; text-align: center; font-size: 12px; color: #6b7280; border-top: 1px solid #333; padding-top: 20px; }
                </style>
            </head>
            <body>
                <div class="container">
                    <div class="header">
                         <!-- Assuming public folder is served at root domain. If not, user needs updates -->
                        <img src="${process.env.NEXT_PUBLIC_APP_URL||"https://promptforge.ai"}/logo_navi.png" alt="PromptForge Studio" class="logo" />
                    </div>
                    
                    <div class="content">
                        ${d.replace(/\n/g,"<br/>")}
                    </div>

                    <div class="quote">
                        <strong>On ${new Date().toLocaleDateString()}, you wrote:</strong><br/>
                        ${c}
                    </div>

                    <div class="footer">
                        &copy; ${new Date().getFullYear()} PromptForge Studio. All rights reserved.
                    </div>
                </div>
            </body>
            </html>
            `});if(f)return console.error("Resend Error:",f),{error:f.message};return{success:!0}}catch(a){return console.error("Failed to send email:",a),{error:"Internal Server Error"}}}async function t(a,b){await l();let c=(0,h.createAdminClient)(),{error:d}=await c.from("profiles").update({subscription_tier:b}).eq("id",a);return d?(console.error("Error updating subscription",d),{error:"Failed to update subscription"}):{success:!0}}async function u(a){await l();let b=(0,h.createAdminClient)(),{error:c}=await b.auth.admin.updateUserById(a,{ban_duration:"876000h"});return c?(console.error("Error banning user",c),{error:"Failed to ban user"}):{success:!0}}async function v(a){await l();let b=(0,h.createAdminClient)();await b.from("profiles").delete().eq("id",a);let{error:c}=await b.auth.admin.deleteUser(a);return c?(console.error("Error deleting user",c),{error:"Failed to delete user"}):{success:!0}}(0,k.ensureServerEntryExports)([m,n,o,p,q,s,t,u,v]),(0,g.registerServerReference)(m,"00c39c99a43f29a6a32b41ff60399f594b8974e3a0",null),(0,g.registerServerReference)(n,"00c42a032424042706b9e42e37d5981bf51f481b98",null),(0,g.registerServerReference)(o,"00274a4c87dab9dcff388011db843c68eeba96ceb3",null),(0,g.registerServerReference)(p,"60f25a791f75800c807f436270e260537b758d3c94",null),(0,g.registerServerReference)(q,"602f1a9a2d81f72fecfb568a8dc4b1655a038430f1",null),(0,g.registerServerReference)(s,"78d2ee0e98fbc09e98d196a0eb94726e94932dfd9d",null),(0,g.registerServerReference)(t,"609ce62b06d15c71e7ed11ee8987582bae7e96d07a",null),(0,g.registerServerReference)(u,"40cf34a1e6068ff348686dcdbcc2b59c93a7b8d701",null),(0,g.registerServerReference)(v,"406b6f80c6633bbec3ef74cbd2579988aec6c76634",null),a.s([],33152),a.i(33152),a.s(["00111b9df99bf9ed2003fd7840d107810c6a1501a2",()=>f.collectKeylessMetadata,"00274a4c87dab9dcff388011db843c68eeba96ceb3",()=>o,"003a114b94a7aa1e8925eb0e19923e68b842d27fb6",()=>d.createOrReadKeylessAction,"00691a2ad7c998649322bd59bc82086007c43aead9",()=>d.detectKeylessEnvDriftAction,"006aeb6e7970a12213649aa3fb647b23db3302889d",()=>c.getUserRole,"006aebffc138bbe85fa0f45a766f7037c176527adf",()=>e.invalidateCacheAction,"00b21639a03642d5844bfb915c6d5ce1988f5b95e0",()=>b.getUserSubscription,"00c39c99a43f29a6a32b41ff60399f594b8974e3a0",()=>m,"00c42a032424042706b9e42e37d5981bf51f481b98",()=>n,"00cc9b2336771f86628fc29ccfdcef3a59791e3db1",()=>d.deleteKeylessAction,"402c2467f6e6cf2abc92a7099d73b789c8487fe378",()=>f.formatMetadataHeaders,"4046d83504de2ad105c27f09d40df52bfab7c822ad",()=>d.syncKeylessConfigAction,"406b6f80c6633bbec3ef74cbd2579988aec6c76634",()=>v,"40cf34a1e6068ff348686dcdbcc2b59c93a7b8d701",()=>u,"602f1a9a2d81f72fecfb568a8dc4b1655a038430f1",()=>q,"609ce62b06d15c71e7ed11ee8987582bae7e96d07a",()=>t,"60f25a791f75800c807f436270e260537b758d3c94",()=>p,"78d2ee0e98fbc09e98d196a0eb94726e94932dfd9d",()=>s],63733)}];

//# sourceMappingURL=_bd62de77._.js.map