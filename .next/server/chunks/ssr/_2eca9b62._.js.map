{"version":3,"sources":["../../../../lib/supabaseAdmin.ts","../../../../lib/admin.ts","../../../../app/admin/layout.tsx"],"sourcesContent":["import 'server-only'\r\nimport { createClient } from '@supabase/supabase-js'\r\n\r\n/**\r\n * Creates a Supabase client with the Service Role Key.\r\n * THIS CLIENT BYPASSES ALL ROW LEVEL SECURITY (RLS).\r\n * It should ONLY be used in secure server-side contexts (e.g., Webhooks, Cron Jobs).\r\n */\r\nexport const createAdminClient = () => {\r\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\n    const serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY\r\n\r\n    if (!supabaseUrl || !serviceRoleKey) {\r\n        throw new Error('Missing Supabase Environment Variables for Admin Client')\r\n    }\r\n\r\n    return createClient(supabaseUrl, serviceRoleKey, {\r\n        auth: {\r\n            autoRefreshToken: false,\r\n            persistSession: false\r\n        }\r\n    })\r\n}\r\n","import { auth } from \"@clerk/nextjs/server\"\r\nimport { createAdminClient } from \"@/lib/supabaseAdmin\"\r\n\r\nexport async function isAdmin() {\r\n    const { userId } = await auth()\r\n\r\n    if (!userId) {\r\n        return false\r\n    }\r\n\r\n    const supabase = createAdminClient()\r\n    const { data: profile } = await supabase\r\n        .from('profiles')\r\n        .select('role')\r\n        .eq('id', userId)\r\n        .single()\r\n\r\n    return profile?.role === 'admin'\r\n}\r\n","import { isAdmin } from \"@/lib/admin\"\r\nimport { redirect } from \"next/navigation\"\r\n\r\nexport default async function AdminLayout({\r\n    children,\r\n}: {\r\n    children: React.ReactNode\r\n}) {\r\n    const isAllowed = await isAdmin()\r\n\r\n    if (!isAllowed) {\r\n        redirect(\"/\")\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen pt-24 pb-12 bg-[#050508] relative overflow-hidden selection:bg-brand-purple/30 text-white\">\r\n            {/* Ambient Background Effects */}\r\n            <div className=\"fixed top-0 left-0 w-full h-[500px] bg-brand-purple/20 blur-[120px] rounded-full mix-blend-screen opacity-20 pointer-events-none -translate-y-1/2\" />\r\n            <div className=\"fixed bottom-0 right-0 w-[500px] h-[500px] bg-blue-500/10 blur-[120px] rounded-full mix-blend-screen opacity-20 pointer-events-none translate-y-1/3\" />\r\n\r\n            <div className=\"container mx-auto px-6 max-w-7xl relative z-10\">\r\n\r\n                {children}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"uCAAA,EAAA,CAAA,CAAA,OACA,IAAA,EAAA,EAAA,CAAA,CAAA,kCAOiC,KAC7B,IAAM,EAAA,2CACA,EAAiB,QAAQ,GAAG,CAAC,yBAAyB,CAE5D,GAAI,CAAC,GAAe,CAAC,EACjB,MAAM,AAAI,MAAM,EADiB,yDAIrC,MAAO,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,EAAa,EAAgB,CAC7C,KAAM,CACF,kBAAkB,EAClB,gBAAgB,CACpB,CACJ,EACJ,4BCtBA,IAAA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OAEO,eAAe,IAClB,GAAM,QAAE,CAAM,CAAE,CAAG,MAAM,CAAA,EAAA,EAAA,IAAA,AAAI,IAE7B,GAAI,CAAC,EACD,MADS,CACF,EAGX,IAAM,EAAW,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAC5B,CAAE,KAAM,CAAO,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,YACL,MAAM,CAAC,QACP,EAAE,CAAC,KAAM,GACT,MAAM,GAEX,OAAO,GAAS,OAAS,OAC7B,gEClBA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAEe,eAAe,EAAY,UACtC,CAAQ,CAGX,EAOG,OANkB,AAEd,CAAC,KAFmB,CAAA,EAAA,EAAA,CAER,MAFQ,AAAO,KAG3B,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,KAIT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mHAEX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sJACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wJAEf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,0DAEV,MAIjB"}