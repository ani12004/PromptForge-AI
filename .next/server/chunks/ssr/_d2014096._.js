module.exports=[62179,a=>{"use strict";var b=a.i(45618);a.s(["createClerkSupabaseClient",0,a=>(0,b.createClient)("https://cnfmdfwpicltzthzglzj.supabase.co","sb_publishable_H4700JmeezyvZawo6rovMA_z2uVjZuv",{global:{headers:a?{Authorization:`Bearer ${a}`}:void 0}})])},2110,77728,27607,a=>{"use strict";var b=a.i(37936),c=a.i(5072),d=a.i(62179),e=a.i(13095);async function f(){try{let{userId:a,getToken:b}=await (0,c.auth)();if(!a)return"free";let e=await b({template:"supabase"}),f=(0,d.createClerkSupabaseClient)(e),{data:g}=await f.from("profiles").select("subscription_tier").eq("id",a).single();return(g?.subscription_tier||"free").toLowerCase()}catch(a){return console.error("Error fetching subscription:",a),"free"}}async function g(){let{userId:a,getToken:b}=await (0,c.auth)();if(!a)return null;try{let c=await b({template:"supabase"}),e=(0,d.createClerkSupabaseClient)(c),{data:f}=await e.from("profiles").select("role").eq("id",a).single();return f?.role||"user"}catch(a){return console.error("Failed to fetch user role",a),"user"}}(0,e.ensureServerEntryExports)([f]),(0,b.registerServerReference)(f,"0003a3dcf615081a16c914805a79b1208e05658d88",null),a.s(["getUserSubscription",()=>f],2110),(0,e.ensureServerEntryExports)([g]),(0,b.registerServerReference)(g,"0051101ac87c471b7462d604cadbab8a2e54996392",null),a.s(["getUserRole",()=>g],77728);var h=a.i(5246);async function i(){(await (0,h.cookies)()).delete(`__clerk_invalidate_cache_cookie_${Date.now()}`)}(0,e.ensureServerEntryExports)([i]),(0,b.registerServerReference)(i,"00fb695b95eb42dc75b9b2e7e86571a2d3342b32bb",null),a.s(["invalidateCacheAction",()=>i],27607)},12746,a=>{"use strict";a.i(25497);var b=a.i(45618);a.s(["createAdminClient",0,()=>{let a="https://cnfmdfwpicltzthzglzj.supabase.co",c=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!a||!c)throw Error("Missing Supabase Environment Variables for Admin Client");return(0,b.createClient)(a,c,{auth:{autoRefreshToken:!1,persistSession:!1}})}])},64224,a=>{"use strict";var b=a.i(37936),c=a.i(5072),d=a.i(62179),e=a.i(12746);async function f(){let{userId:a}=await (0,c.auth)();if(!a)return{badges:[],userBadges:[]};let b=(0,e.createAdminClient)(),{data:d,error:f}=await b.from("badges").select("*");if(f)return console.error("Error fetching badges:",f),{badges:[],userBadges:[]};let g={Common:1,Skilled:2,Advanced:3,Expert:4,Legendary:5},h=d.sort((a,b)=>(g[a.rarity]||99)-(g[b.rarity]||99));console.log(`[Gamification] Fetching for user: ${a}`);let{data:i,error:j}=await b.from("user_badges").select("*").eq("user_id",a);return j?console.error("Error fetching user badges:",j):console.log(`[Gamification] Found ${i?.length} badges for user ${a}`),{badges:h||[],userBadges:i||[]}}async function g(a){let{userId:b,getToken:e}=await (0,c.auth)();if(!b)return null;let f=await e({template:"supabase"}),g=(0,d.createClerkSupabaseClient)(f),{data:h}=await g.from("badges").select("*").eq("unlock_condition",a).single();if(!h)return null;let{data:i}=await g.from("user_badges").select("*").eq("user_id",b).eq("badge_id",h.id).single();if(i)return null;let{error:j}=await g.from("user_badges").insert({user_id:b,badge_id:h.id});return j?(console.error(`Failed to award badge ${h.name}:`,j),null):h}async function h(a,b){return[]}(0,a.i(13095).ensureServerEntryExports)([f,g,h]),(0,b.registerServerReference)(f,"005e929cf58dbc5d3d9460f531256b1ac300deeff6",null),(0,b.registerServerReference)(g,"4022b9431d7661ca47c7b1768f72ff42c262e00c89",null),(0,b.registerServerReference)(h,"60d2f4c975de1fdd95187e9bda0feccf9f61b21f4b",null),a.s(["awardBadge",()=>g,"getBadges",()=>f])},86595,a=>{"use strict";var b=a.i(2110),c=a.i(77728),d=a.i(26022),e=a.i(27607),f=a.i(85978),g=a.i(64224);a.s([],85403),a.i(85403),a.s(["0003a3dcf615081a16c914805a79b1208e05658d88",()=>b.getUserSubscription,"000c5950602641cd8b0661a788cb4fb705def1b4b1",()=>d.createOrReadKeylessAction,"0051101ac87c471b7462d604cadbab8a2e54996392",()=>c.getUserRole,"005e929cf58dbc5d3d9460f531256b1ac300deeff6",()=>g.getBadges,"0064afb0bd84c5266927f4777c8f0ddd5c7e626c6a",()=>d.deleteKeylessAction,"008a5782a58bd8eba0077f5b1e478761fed9d410df",()=>f.collectKeylessMetadata,"00d33c04adba09f9320585b6cd2442fddc67121317",()=>d.detectKeylessEnvDriftAction,"00fb695b95eb42dc75b9b2e7e86571a2d3342b32bb",()=>e.invalidateCacheAction,"40e8dbb7737be346be89256c32890a354586b96faf",()=>f.formatMetadataHeaders,"40efc55e4105d4adbc9874f14cc1c800be70aff8bc",()=>d.syncKeylessConfigAction],86595)}];

//# sourceMappingURL=_d2014096._.js.map