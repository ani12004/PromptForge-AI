module.exports=[2110,77728,27607,a=>{"use strict";var b=a.i(37936),c=a.i(5072),d=a.i(62179),e=a.i(13095);async function f(){try{let{userId:a,getToken:b}=await (0,c.auth)();if(!a)return"free";let e=await b({template:"supabase"}),f=(0,d.createClerkSupabaseClient)(e),{data:g}=await f.from("profiles").select("subscription_tier").eq("id",a).single();return(g?.subscription_tier||"free").toLowerCase()}catch(a){return console.error("Error fetching subscription:",a),"free"}}async function g(){let{userId:a,getToken:b}=await (0,c.auth)();if(!a)return null;try{let c=await b({template:"supabase"}),e=(0,d.createClerkSupabaseClient)(c),{data:f}=await e.from("profiles").select("role").eq("id",a).single();return f?.role||"user"}catch(a){return console.error("Failed to fetch user role",a),"user"}}(0,e.ensureServerEntryExports)([f]),(0,b.registerServerReference)(f,"00b21639a03642d5844bfb915c6d5ce1988f5b95e0",null),a.s(["getUserSubscription",()=>f],2110),(0,e.ensureServerEntryExports)([g]),(0,b.registerServerReference)(g,"006aeb6e7970a12213649aa3fb647b23db3302889d",null),a.s(["getUserRole",()=>g],77728);var h=a.i(5246);async function i(){(await (0,h.cookies)()).delete(`__clerk_invalidate_cache_cookie_${Date.now()}`)}(0,e.ensureServerEntryExports)([i]),(0,b.registerServerReference)(i,"006aebffc138bbe85fa0f45a766f7037c176527adf",null),a.s(["invalidateCacheAction",()=>i],27607)},52157,a=>{"use strict";var b=a.i(37936),c=a.i(62179),d=a.i(5072);async function e(a,b,e){let{userId:f,getToken:g}=await (0,d.auth)();if(!f)return{success:!1,error:"Unauthorized"};try{let d=await g({template:"supabase"}),h=(0,c.createClerkSupabaseClient)(d),{data:i,error:j}=await h.from("prompt_analytics").update({feedback_score:b,feedback_comment:e}).eq("prompt_version_id",a).eq("user_id",f).select();if(j)return console.error("Error submitting feedback:",j),{success:!1,error:j.message};return{success:!0}}catch(a){return console.error("Exception in submitFeedback:",a),{success:!1,error:"Internal server error"}}}async function f(){let{userId:a,getToken:b}=await (0,d.auth)();if(!a)return{success:!1,error:"Unauthorized"};try{let d=await b({template:"supabase"}),e=(0,c.createClerkSupabaseClient)(d),{data:f,error:g}=await e.from("prompt_analytics").select("created_at, tokens_input, tokens_output, latency_ms, cost_micro_usd").eq("user_id",a).order("created_at",{ascending:!0});if(g)return console.error("Error fetching analytics:",g),{success:!1,error:g.message};if(!f||0===f.length)return{success:!0,data:{totalPrompts:0,totalTokens:0,totalCost:0,avgLatency:0,usageOverTime:[]}};let h=0,i=0,j=0,k={};f.forEach(a=>{h+=(a.tokens_input||0)+(a.tokens_output||0),i+=a.cost_micro_usd||0,j+=a.latency_ms||0;let b=new Date(a.created_at).toISOString().split("T")[0];k[b]=(k[b]||0)+1});let l=Math.round(j/f.length),m=Object.entries(k).map(([a,b])=>({date:a,count:b})).sort((a,b)=>a.date.localeCompare(b.date));return{success:!0,data:{totalPrompts:f.length,totalTokens:h,totalCost:i,avgLatency:l,usageOverTime:m}}}catch(a){return console.error("Exception in getDashboardMetrics:",a),{success:!1,error:"Internal server error"}}}async function g(){let{userId:a,getToken:b}=await (0,d.auth)();if(!a)return{success:!1,error:"Unauthorized"};try{let d=await b({template:"supabase"}),e=(0,c.createClerkSupabaseClient)(d),{data:f,error:g}=await e.from("prompt_analytics").select("prompt_version_id, feedback_score, tokens_output, cost_micro_usd, created_at").eq("user_id",a).order("feedback_score",{ascending:!1,nullsFirst:!1}).order("created_at",{ascending:!1}).limit(5);if(g)return{success:!1,error:g.message};if(!f||0===f.length)return{success:!0,data:[]};let h=f.map(a=>a.prompt_version_id),{data:i,error:j}=await e.from("prompt_versions").select("id, content, prompt_id").in("id",h);if(j)return{success:!1,error:j.message};let k=f.map(a=>{let b=i?.find(b=>b.id===a.prompt_version_id);return{id:a.prompt_version_id,promptId:b?.prompt_id||"",content:b?.content||"Unknown Prompt",score:a.feedback_score||0,tokens:a.tokens_output||0,cost:a.cost_micro_usd||0,timestamp:a.created_at}});return{success:!0,data:k}}catch(a){return console.error("Exception in getTopPrompts:",a),{success:!1,error:"Internal server error"}}}(0,a.i(13095).ensureServerEntryExports)([e,f,g]),(0,b.registerServerReference)(e,"7086522510578d9df8da140396dbbea3d5e33f0a9a",null),(0,b.registerServerReference)(f,"00a51404e0c797f2d2e172868c85c07e0efca42b35",null),(0,b.registerServerReference)(g,"00c974d269de6ff5349b8e509eccfb2a58a22596ef",null),a.s(["getDashboardMetrics",()=>f,"getTopPrompts",()=>g,"submitFeedback",()=>e])},58376,a=>{"use strict";var b=a.i(2110),c=a.i(77728),d=a.i(26022),e=a.i(27607),f=a.i(85978),g=a.i(52157);a.s([],85696),a.i(85696),a.s(["00111b9df99bf9ed2003fd7840d107810c6a1501a2",()=>f.collectKeylessMetadata,"003a114b94a7aa1e8925eb0e19923e68b842d27fb6",()=>d.createOrReadKeylessAction,"00691a2ad7c998649322bd59bc82086007c43aead9",()=>d.detectKeylessEnvDriftAction,"006aeb6e7970a12213649aa3fb647b23db3302889d",()=>c.getUserRole,"006aebffc138bbe85fa0f45a766f7037c176527adf",()=>e.invalidateCacheAction,"00a51404e0c797f2d2e172868c85c07e0efca42b35",()=>g.getDashboardMetrics,"00b21639a03642d5844bfb915c6d5ce1988f5b95e0",()=>b.getUserSubscription,"00c974d269de6ff5349b8e509eccfb2a58a22596ef",()=>g.getTopPrompts,"00cc9b2336771f86628fc29ccfdcef3a59791e3db1",()=>d.deleteKeylessAction,"402c2467f6e6cf2abc92a7099d73b789c8487fe378",()=>f.formatMetadataHeaders,"4046d83504de2ad105c27f09d40df52bfab7c822ad",()=>d.syncKeylessConfigAction],58376)}];

//# sourceMappingURL=_8201ef75._.js.map